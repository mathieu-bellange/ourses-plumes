<!doctype html>
<html lang="fr">
	<head>
		<script src="boot.js"></script>
	</head>
	<body>

		<h2 class="red">Agenda <small>.date-table</small></h2>

		<!--Agenda-->
		<section id="agenda">
			<!--Date Switcher-->
			<div class="date-switcher">
				<h3>Juillet 2014</h3>
				<a href="javascript:void(0)" class="prev icon-left" title="Pr&eacute;c&eacute;dent"></a>
				<a href="javascript:void(0)" class="next icon-right" title="Suivant"></a>
			</div>
			<!--Date Table-->
			<table class="date-table">
				<thead>
					<tr>
						<th>Lun<span class="date-name-suffix">di</span></th>
						<th>Mar<span class="date-name-suffix">di</span></th>
						<th>Mer<span class="date-name-suffix">credi</span></th>
						<th>Jeu<span class="date-name-suffix">di</span></th>
						<th>Ven<span class="date-name-suffix">dredi</span></th>
						<th>Sam<span class="date-name-suffix">edi</span></th>
						<th>Dim<span class="date-name-suffix">anche</span></th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td></td>
						<td><div class="over-block"><time datetime="2014-07-01">1</time></div></td>
						<td>
							<div class="over-block has-event">
								<time datetime="2014-07-02">2</time>
								<ul class="event-list hide">
									<li><strong class="title">Colloque</strong><span class="hide">&#8201;: </span><span class="text hide">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras fringilla sem vitae justo aliquet, semper tempus quam scelerisque. Maecenas quis neque urna. Donec ut iaculis magna. Sed fermentum, leo at sodales pellentesque, ante nibh pharetra mauris metus.</span></li>
									<li><strong class="title">Expo</strong></li>
									<li><strong class="title"></strong></li>
									<li></li>
									<li><strong class="title">D&eacute;bat public</strong><span class="hide">&#8201;: </span><span class="text hide">&nbsp;</span></li>
									<li><strong class="title"><del>Manif</del></strong><span class="hide">&#8201;: </span><span class="text hide">Annulé !</span></li>
									<li><strong class="title">Concert</strong><span class="hide">&#8201;: </span><span class="text hide">C'est à 22 heures !</span></li>
								</ul>
								<a class="over" href="javascript:void(0)"></a>
							</div>
						</td>
						<td>
							<div class="over-block has-event">
								<time datetime="2014-07-03">3</time>
								<ul class="event-list hide">
									<li><strong class="title">Ap&eacute;ro g&eacute;ant</strong></li>
								</ul>
								<a class="over" href="javascript:void(0)"></a>
							</div>
						</td>
						<td><div class="over-block"><time datetime="2014-07-04">4</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-05">5</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-06">6</time></div></td>
					</tr>
					<tr>
						<td><div class="over-block"><time datetime="2014-07-07">7</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-08">8</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-09">9</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-10">10</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-11">11</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-12">12</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-13">13</time></div></td>
					</tr>
					<tr>
						<td>
							<div class="over-block has-event">
								<time datetime="2014-07-14">14</time>
								<ul class="event-list hide">
									<li><strong class="title">F&ecirc;te nationale</strong></li>
								</ul>
								<a class="over" href="javascript:void(0)"></a>
							</div>
						</td>
						<td><div class="over-block"><time datetime="2014-07-15">15</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-16">16</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-17">17</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-18">18</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-19">19</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-20">20</time></div></td>
					</tr>
					<tr>
						<td><div class="over-block"><time datetime="2014-07-21">21</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-22">22</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-23">23</time></div></td>
						<td>
							<div class="over-block has-event">
								<time datetime="2014-07-24">24</time>
								<ul class="event-list hide">
									<li>Marche des fiert&eacute;s</li>
									<li>Anniv Popi</li>
								</ul>
								<a class="over" href="javascript:void(0)"></a>
							</div>
						</td>
						<td><div class="over-block"><time datetime="2014-07-25">25</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-26">26</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-27">27</time></div></td>
					</tr>
					<tr>
						<td><div class="over-block"><time datetime="2014-07-28">28</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-29">29</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-30">30</time></div></td>
						<td><div class="over-block"><time datetime="2014-07-31">31</time></div></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>
				</tbody>
			</table>
		</section>
		<script>
		var agenda_ui = (function() {
			var cfg = {
				"fx_d"        : 375, // [Int]  Duration of effects (ms). Default : 375
				"ev_t"        : 500, // [Int]  Timeout before showing date events (ms). Default : 500
				"show_events" : true // [Bool] Show sliding date events ? Default : true
			};
			return {
				init : function(opts) {
					cfg = $.extend({}, cfg, opts);
					$(document).on("mouseenter", ".has-event", function() {
						if (isComputer() && cfg.show_events) {
							var self = $(this);
							self.data("hover", true);
							setTimeout(function() {
								if (self.data("hover") == true) {
									self.css({"width" : self.outerWidth(), "position" : "absolute", "z-index" : "1"});
									self.children(".event-list").slideDown($conf.js_fx ? cfg.fx_d / 2 : 0);
								}
							}, cfg.ev_t);
						}
					});
					$(document).on("mouseleave", ".has-event", function() {
						if (isComputer() && cfg.show_events) {
							var self = $(this);
							self.data("hover", false);
							self.children(".event-list").slideUp($conf.js_fx ? cfg.fx_d : 0, function() {
								self.css({"width" : "", "position" : "", "z-index" : ""});
							});
						}
					});
					$(document).on("click", ".has-event", function() {
						if ($(".reveal-modal").is(":visible")) {
							if (!$("html").data("revealing-modal")) {
								$(".reveal-modal").foundation("reveal", "close");
							}
						} else {
							// Create modal
							var e = [];
							$(this).find(".event-list").children("li").each(function() {
								var title = $(this).find(".title").text().trim() || null;
								var text = $(this).find(".text").text().trim() || null;
								if (title) {e.push({"title" : title, "text" : (text ? text : null)})}
							});
							var d = $(this).find("time").first().attr("datetime") || 0;  // Datetime
							var a = d.split("-"); // YMD array
							var t = new Date(a[0], a[1], a[2]); // Timestamp
							var c = {
								"id"       : d,
								"date"     : $time.days[t.getDay()].capitalize() + " " + dateToHTML(t),
								"events"   : e
							};
							var modal = $(file_pool.date_modal_tmpl(c));
							// Append modal
							$("body").append(modal);
							// Reload SVG icons
							modal.svg_icons();
							// Initialize modal
							modal.foundation("reveal", "open");
							// Bind live events
							$(document).on("open", ".reveal-modal", function() {
								$("html").data("revealing-modal", true);
							});
							$(document).on("close", ".reveal-modal", function() {});
							$(document).on("opened", ".reveal-modal", function() {
								$("html").removeData("revealing-modal");
							});
							$(document).on("closed", ".reveal-modal", function() {
								$(this).detach();
							});
						}
					});
				}
			}
		}());
		agenda_ui.init();
		</script>
		<script>
			$build.container = false;
			load();
		</script>
	</body>
</html>

<!doctype html>
<html lang="fr">
	<head>
		<script src="boot.js"></script>
	</head>
	<body>

		<script>
			var folder_edit = true;
			var loax_pool = {
				"folder_view_mptl" : $loc.tmpl + "folder-view.mptl",
				"folder_edit_mptl" : $loc.tmpl + "folder-edit.mptl"
			};
		</script>

		<!--Dev Testbar-->
		<div id="dev_testbar" class="">
			<svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" viewBox="0 0 48 48">
				<polygon points="27,35.59 40,22.59 40,31.91 24,47.91 8,31.91 8,22.59 21,35.59 21,0 27,0 "/>
			</svg>
			<h4>Voir</h4>
			<label for="show_folder_switcher">Barre</label>
			<input id="show_folder_switcher" type="checkbox" name="show" value="folder_switcher">
			<label for="show_folder_list_view">Visualisation</label>
			<input id="show_folder_list_view" type="checkbox" name="show" value="folder_list_view" checked>
			<label for="show_folder_list_edit">Édition</label>
			<input id="show_folder_list_edit" type="checkbox" name="show" value="folder_list_edit" checked>
			<label for="show_link_to_a_folder">Liens</label>
			<input id="show_link_to_a_folder" type="checkbox" name="show" value="link_to_a_folder" checked>
			<label for="test_overflow">D&eacute;bordement</label>
			<input id="test_overflow" type="checkbox" name="show">
			<label>Largeur</label>
			<input id="section_width_slider" type="range" min="20" max="120" step="10" value="100">
			<span id="section_width_tip"></span>
		</div>
		<script>
			// Functions
			function change_width(selector) {
				var w = $(selector).val() + "%";
				$("section").css("width", w);
				$("#section_width_tip").text(w + " (" + $("section").outerWidth(true) + "px)");
			}
			function check_test_overflow() {$("#test_overflow").is(":checked") ? $(".test-overflow").show() : $(".test-overflow").hide()}
			// Eventing
			$("html").on("click", "[name='show']", function() {
				var f = $(this).val();
				$("#" + f).toggle();
			});
			$("#section_width_slider").change(function() {change_width(this)});
			$("#section_width_slider").keyup(function() {change_width(this)});
			$("#debug_marks").change(function() {check_debug_marks(this)});
			$("#test_overflow").change(function() {check_test_overflow()});
			// Initialization
			$(document).ready(function() {
				$("[name='show']").each(function() {
					var f = $(this).val();
					if ($(this).is(":checked")) {
						$("#" + f).show();
					} else {
						$("#" + f).hide();
					}
				});
				change_width("#section_width_slider");
				check_test_overflow();
			});
		</script>

		<div id="dev_container">

			<h2 class="red">Dossiers <small>.folders</small></h2>

			<!--Folder Switcher-->
			<div id="folder_switcher" style="margin-bottom: 1rem;">
				<h3>Article dans un dossier</h3>
				<div class="folder-switcher">
					<a href="javascript:void(0)" class="prev" title="Article précédent">
						<span class="icon-left large"></span>
						<span class="hide">Article précédent : </span>
						<span class="text-label" style="">Avortement : un droit mal acquis<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></span>
					</a>
					<h4 class="icon-folder"><span class="hide">Dossier : </span><a href="javascript:void(0)" title="Aller au dossier">Natalité<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a></h4>
					<a href="javascript:void(0)" class="next" title="Article suivant">
						<span class="icon-right large"></span>
						<span class="hide">Article suivant : </span>
						<span class="text-label" style="">La guerre des poupons<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></span>
					</a>
				</div>
			</div>

			<!--Folders List View-->
			<div id="folder_list_view">
				<h3>Voir la liste des dossiers</h3>
				<!--
				<ul class="folder-list">
					<li id="v1" class="folder">
						<div class="name" tabindex="0">
							<h4 class="icon-folder">Égalité des sexes<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></h4>
							<span class="icon-cancel small vis-toggle" tabindex="0" title="Fermer le dossier"></span>
						</div>
						<div class="desc">
							<p>Description &hellip; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Maecenas sagittis vitae risus eget consectetur. Proin euismod bibendum massa, nec ultricies felis posuere a. Curabitur aliquet vestibulum ante et auctor. Suspendisse ut sapien sed nisl semper egestas in vitae eros. Donec et leo a nisl condimentum consequat vel et velit.</p>
							<p>Description &hellip; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Maecenas sagittis vitae risus eget consectetur. Proin euismod bibendum massa, nec ultricies felis posuere a. Curabitur aliquet vestibulum ante et auctor. Suspendisse ut sapien sed nisl semper egestas in vitae eros. Donec et leo a nisl condimentum consequat vel et velit.</p>
							<p>Description &hellip; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Maecenas sagittis vitae risus eget consectetur. Proin euismod bibendum massa, nec ultricies felis posuere a. Curabitur aliquet vestibulum ante et auctor. Suspendisse ut sapien sed nisl semper egestas in vitae eros. Donec et leo a nisl condimentum consequat vel et velit.</p>
						</div>
						<ul class="list">
							<li><span class="icon-ourbody small"></span><a href="javascript:void(0)">Le troisième sexe<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a></li>
							<li><span class="icon-intersec small"></span><a href="javascript:void(0)">Parité : une théorie éculée ?<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a></li>
						</ul>
					</li>
					<li id="v2" class="folder">
						<div class="name" tabindex="0">
							<h4 class="icon-folder">Natalité<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></h4>
							<span class="icon-cancel small vis-toggle" tabindex="0" title="Fermer le dossier"></span>
							</div>
						<div class="desc">
							<p>Description &hellip; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Maecenas sagittis vitae risus eget consectetur. Proin euismod bibendum massa, nec ultricies felis posuere a. Curabitur aliquet vestibulum ante et auctor. Suspendisse ut sapien sed nisl semper egestas in vitae eros. Donec et leo a nisl condimentum consequat vel et velit.</p>
						</div>
						<ul class="list">
							<li><span class="icon-struggles small"></span><a href="javascript:void(0)">Avortement : un droit mal acquis<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a></li>
							<li><span class="icon-ourbody small"></span><a href="javascript:void(0)">Gestation pour autrui, une autre étape ?<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a></li>
							<li><span class="icon-internat small"></span><a href="javascript:void(0)">La guerre des poupons<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a></li>
						</ul>
					</li>
				</ul>
				-->
			</div>


			<!--Folders List Edit-->
			<div id="folder_list_edit">
				<h3>Modifier la liste des dossiers</h3>
				<!--
				<ul class="folder-list edit">
					<li id="e1" class="folder">
						<div class="name" tabindex="0"><h4 class="icon-folder">Égalité des sexes<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></h4></div>
						<div class="name" style="display: none;">
							<span class="icon-folder"></span><input type="text" maxlength="64" value="Égalité des sexes" placeholder="Le titre du dossier">
							<span class="icon-cancel small vis-toggle" tabindex="0" title="Fermer le dossier"></span>
						</div>
						<div class="desc">
							<textarea class="min" maxlength="1024" placeholder="La description du dossier (1024 charact&egrave;res max.)">Description … Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Maecenas sagittis vitae risus eget consectetur. Proin euismod bibendum massa, nec ultricies felis posuere a. Curabitur aliquet vestibulum ante et auctor. Suspendisse ut sapien sed nisl semper egestas in vitae eros. Donec et leo a nisl condimentum consequat vel et velit.</textarea>
						</div>
						<ul class="list">
							<li><span class="icon-ourbody small"></span><a href="javascript:void(0)">Le troisième sexe<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a>
								<div class="button-bar">
									<span class="icon-up button tiny disabled" tabindex="-1"></span>
									<span class="icon-down button tiny" tabindex="0" title="Descendre l&rsquo;article dans le dossier"></span>
									<span class="icon-cancel button alert tiny" tabindex="0" title="Retirer l&rsquo;article du dossier"></span>
								</div>
							</li>
							<li><span class="icon-intersec small"></span><a href="javascript:void(0)">Parité : une théorie éculée ?<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a>
								<div class="button-bar">
									<span class="icon-up button tiny" tabindex="0" title="Monter l&rsquo;article dans le dossier"></span>
									<span class="icon-down button tiny disabled" tabindex="-1"></span>
									<span class="icon-cancel button alert tiny" tabindex="0" title="Retirer l&rsquo;article du dossier"></span>
								</div>
							</li>
						</ul>
						<div class="text-center button-bar">
							<button class="icon-confirm success small" title="Valider les modifications" data-submit><span class="text">Valider</span></button>
							<button class="icon-cancel alert small" title="Annuler les modifications" data-cancel><span class="text">Annuler</span></button>
							<button class="icon-remove alert tiny right" title="Supprimer le dossier" data-delete><span class="text hide">Supprimer</span></button>
						</div>
					</li>
					<li id="e2" class="folder">
						<div class="name" tabindex="0"><h4 class="icon-folder">Natalité<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></h4></div>
						<div class="name" style="display: none;">
							<span class="icon-folder"></span><input type="text" maxlength="64" value="Natalité" placeholder="Le titre du dossier">
							<span class="icon-cancel small vis-toggle" tabindex="0" title="Fermer le dossier"></span>
						</div>
						<div class="desc">
							<textarea class="min" maxlength="1024" placeholder="La description du dossier (1024 charact&egrave;res max.)">Description … Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Maecenas sagittis vitae risus eget consectetur. Proin euismod bibendum massa, nec ultricies felis posuere a. Curabitur aliquet vestibulum ante et auctor. Suspendisse ut sapien sed nisl semper egestas in vitae eros. Donec et leo a nisl condimentum consequat vel et velit.</textarea>
						</div>
						<ul class="list">
							<li><span class="icon-struggles small"></span><a href="javascript:void(0)">Avortement : un droit mal acquis<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a>
								<div class="button-bar">
									<span class="icon-up button tiny disabled" tabindex="-1"></span>
									<span class="icon-down button tiny" tabindex="0" title="Descendre l&rsquo;article dans le dossier"></span>
									<span class="icon-cancel button alert tiny" tabindex="0" title="Retirer l&rsquo;article du dossier"></span>
								</div>
							</li>
							<li><span class="icon-ourbody small"></span><a href="javascript:void(0)">Gestation pour autrui, une autre étape ?<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a>
								<div class="button-bar">
									<span class="icon-up button tiny" tabindex="0" title="Monter l&rsquo;article dans le dossier"></span>
									<span class="icon-down button tiny" tabindex="0" title="Descendre l&rsquo;article dans le dossier"></span>
									<span class="icon-cancel button alert tiny" tabindex="0" title="Retirer l&rsquo;article du dossier"></span>
								</div>
							</li>
							<li><span class="icon-internat small"></span><a href="javascript:void(0)">La guerre des poupons<span class="test-overflow"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper. Phasellus eget eros orci. Sed vulputate hendrerit eros a semper.</span></a>
								<div class="button-bar">
									<span class="icon-up button tiny" tabindex="0" title="Monter l&rsquo;article dans le dossier"></span>
									<span class="icon-down button tiny disabled" tabindex="-1"></span>
									<span class="icon-cancel button alert tiny" tabindex="0" title="Retirer l&rsquo;article du dossier"></span>
								</div>
							</li>
						</ul>
					</li>
				</ul>
				<div class="button-bar">
					<button class="icon-add" data-add><span class="text">Nouveau dossier</span></button>
				</div>
				-->
			</div>
			<script>
				var db_rubrique = [
					{"id" : 1, "classe" : "struggles"},
					{"id" : 2, "classe" : "ourbody"},
					{"id" : 3, "classe" : "intersec"},
					{"id" : 4, "classe" : "internat"},
					{"id" : 5, "classe" : "educult"},
					{"id" : 6, "classe" : "ideas"}
				];
				var db_article = [
					{"id" : 1, "title" : "Le troisième sexe", "rubrique_id" : 1, "path" : "javascript:void(0)"},
					{"id" : 2, "title" : "Gestation pour autrui, une autre étape ?", "rubrique_id" : 1, "path" : "javascript:void(0)"},
					{"id" : 3, "title" : "Parité : une théorie éculée ?", "rubrique_id" : 2, "path" : "javascript:void(0)"},
					{"id" : 4, "title" : "Avortement : un droit mal acquis", "rubrique_id" : 4, "path" : "javascript:void(0)"},
					{"id" : 5, "title" : "La guerre des poupons", "rubrique_id" : 3, "path" : "javascript:void(0)"}
				];
				var db_folder = [
					{
						"id" : 1,
						"hash" : "natalite",
						"name" : "Natalité",
						"desc" : "<p>Le dossier qui regroupe les sujets sur la natalité.</p>",
						"list" : [
							{"num" : 6, "id" : 5},
							{"num" : 7, "id" : 4},
							{"num" : 3, "id" : 2}
						]
					},
					{
						"id" : 2,
						"hash" : "egalite-des-sexes",
						"name" : "Égalité des sexes",
						"desc" : "<p>Le dossier qui regroupe les sujets sur l'égalité des sexes.</p>",
						"list" : [
							{"num" : 0, "id" : 1},
							{"num" : 1, "id" : 3},
						]
					}
				];
				function sort_list_by_num(a) {
					var b = [], c = [];
					for (n in a) {
						b.push(a[n].num);
					} b.sort(function(a, b) {return a - b});
					for (var i = 0; i < b.length; i++) {
						for (n in a) {
							if (a[n].num == b[i]) {
								c.push(a[n]);
							}
						}
					} return c;
				}
				$(document).ready(function() {
					// 1. Build folder list template
					$("#folder_list_view").append(file_pool.folder_view_list_tmpl(db_folder));
					$("#folder_list_edit").append(file_pool.folder_edit_list_tmpl(db_folder));
					// 2. Build folder list item
					$(".folder .list li").each(function() {
						var id = $(this).attr("data-id"), a = db_article;
						if (typeof(id) !== "undefined") {
							for (k in a) {
								if (a[k].id == id) {
									$(this).prepend(file_pool.folder_list_item_tmpl({"title" : a[k].title, "rubric" : " rubric-id-" + a[k].rubrique_id, "path" : a[k].path}));
								}
							}
						}
					});
					// 3. Update rubric id from db
					$("[class*='rubric-id']").each(function() {
						var o = $(this), d = db_rubrique, r = o.attr("class").match(/rubric-id-(\d*)/), c;
						for (n in d) {
							if (d[n].id == r[1]) {
								c = d[n].classe;
							}
						}
						o.removeClass(r[0]);
						o.addClass("icon-" + c);
					});
					$(".folder-list").svg_icons(); // reload svg icons
				});
			</script>

			<!--Link to a folder-->
			<div id="link_to_a_folder">
				<h3>Lien vers un dossier</h3>
				<ul>
					<li><a href="_test_folders.html#natalite" target="_blank">Voir le dossier n°1 dans une nouvelle fenêtre</a></li>
					<li><a href="_test_folders.html#egalite-des-sexes" target="_blank">Voir le dossier n°2 dans une nouvelle fenêtre</a></li>
					<li><a href="_test_folders.html#natalite-edit" target="_blank">Modifier le dossier n°1 dans une nouvelle fenêtre</a></li>
					<li><a href="_test_folders.html#egalite-des-sexes-edit" target="_blank">Modifier le dossier n°2 dans une nouvelle fenêtre</a></li>
				</ul>
				<script>
					$(document).ready(function() {
						folder_ui.init();
					});
				</script>
			</div>
		</div>

		<script>
			$build.container = false;
			load();
		</script>
	</body>
</html>

<!doctype html>
<html lang="fr">
	<head>
		<script src="boot.js"></script>
	</head>
	<body>
		<script>
			load();
		</script>
		<script>
			/* Insert Template */
			$("main > header").after(doT.compile(loadfile($loc.tmpl + "_dev_notes.tmpl")));
			/* CSS Units Converter */
			$("#css_unit_base, #css_unit_px, #css_unit_rem").keydown(function(e) {
				if (e.which == 46) { // Suppr
					$(this).val(0);
				} else if ((e.which >= 64 && e.which <= 90)) { // From A to Z
					e.preventDefault();
				} else if (e.which == 33 || e.which == 34 || e.which == 38 || e.which == 40) { // PageUp or PageDown or or Up or Down
					var i = $(this).val();
					switch (e.which) {
						case 33 : // PageUp
							$(this).val(parseInt(i) + 10);
							break;
						case 34 : // PageDown
							$(this).val(parseInt(i) - 10);
							break;
						case 38 : // Up
							$(this).val(parseInt(i) + 1);
							break;
						case 40 : // Down
							$(this).val(parseInt(i) - 1);
							break;
					}
				}
			});
			$("#css_unit_base").keyup(function(e) {
				if (e.which == 13 || e.which == 33 || e.which == 34 || e.which == 38 || e.which == 40 || (e.which >= 48 && e.which <= 57) || (e.which >= 96 && e.which <= 105)) { // Enter or PageUp or PageDown or or Up or Down or from 0 to 9 or from Numpad 0 to Numpad 9
					//$("#css_unit_rem").val(($("#css_unit_px").val() / $("#css_unit_base").val()).toFixed(4).replace(/\.0+|0+$/, ""));
					$("#css_unit_px").val(($("#css_unit_rem").val() * $("#css_unit_base").val()).toFixed(4).replace(/\.0+|0+$/, ""));
				}
			});
			$("#css_unit_px").keyup(function(e) {
				if (e.which == 13 || e.which == 33 || e.which == 34 || e.which == 38 || e.which == 40 || (e.which >= 48 && e.which <= 57) || (e.which >= 96 && e.which <= 105)) { // Enter or PageUp or PageDown or or Up or Down or from 0 to 9 or from Numpad 0 to Numpad 9
					$("#css_unit_rem").val(($(this).val() / $("#css_unit_base").val()).toFixed(4).replace(/\.0+|0+$/, ""));
				}
			});
			$("#css_unit_rem").keyup(function(e) {
				if (e.which == 13 || e.which == 33 || e.which == 34 || e.which == 38 || e.which == 40 || (e.which >= 48 && e.which <= 57) || (e.which >= 96 && e.which <= 105)) { // Enter or PageUp or PageDown or or Up or Down or from 0 to 9 or from Numpad 0 to Numpad 9
					$("#css_unit_px").val(($(this).val() * $("#css_unit_base").val()).toFixed(4).replace(/\.0+|0+$/, ""));
				}
			});
			/* CSS Colors */
			$(document).ready(function() {
				function create_block(color) {
					return $("<div>", {"id": color})
						.css({
							"display" : "inline-block",
							"width" : "1.875rem",
							"text-align" : "center",
							"border" : ".125rem solid rgba(0, 0, 0, .25)",
							"background-color" : color
						})
						.html("&nbsp;");
				}
				$("#css_colors_table tr:gt(0)").each(function() {
					var name = $(this).find(":nth-child(2)").text();
					var hex = $(this).find(":nth-child(3)").text();
					var rgb = $(this).find(":nth-child(4)").text();
					var reg = rgb.match(/(\d{1,3})/g);
					var rex = parseFloat(reg[0]),
							gex = parseFloat(reg[1]),
							bex = parseFloat(reg[2]);
					var hue = null;
					var max = Math.max(rex, gex, bex);
					var min = Math.min(rex, gex, bex);
					var med = max - min;
					var r = (rex - min) / max;
					var g = (gex - min) / max;
					var b = (bex - min) / max;
					if (med == 0) { // grayscale
						//hue = null;
					} else if (rex == max) { // red
						if (bex > gex) {
							hue = Math.abs(60 * (6 + (gex - bex) / med)).toFixed(1);
						} else {
							hue = Math.abs(60 * (gex - bex) / med).toFixed(1);
						}
					} else if (gex == max) { // green
						hue = Math.abs(60 * (2 + (bex - rex) / med)).toFixed(1);
					} else if (bex == max){ // blue
						hue = Math.abs(60 * (4 + (rex - gex) / med)).toFixed(1);
					} else {
						alert("error ! " + name + " : " + hue); // DEBUG
					}
					if (rex < 48 && gex < 48 && bex < 48) { // black
						$(this).attr("data-color", "black");
					} else if (rex > 224 && gex > 224 && bex > 224) { // white
						$(this).attr("data-color", "white");
					} else if (hue == null) { // true gray
						$(this).attr("data-color", "grey");
					} else if (hue <= 17.5 || (hue > 345 && hue <= 360)) { // red
						if (r - g > 0.6 && g - b < 0.5) {
							$(this).attr("data-color", "red");
						} else {
							$(this).attr("data-color", "pink");
						}
					} else if (hue <= 40) { // orange
						if (r - g < 0.5 && g - b > 0.35) {
							$(this).attr("data-color", "orange");
						} else {
							$(this).attr("data-color", "brown");
						}
					} else if (hue <= 60 && rex > 128 && gex > 128) { // yellow
						$(this).attr("data-color", "yellow");
					} else if (hue <= 157.5) { // green
						$(this).attr("data-color", "green");
					} else if (hue <= 190) { // cyan
						$(this).attr("data-color", "cyan");
					} else if (hue <= 255) { // blue
						$(this).attr("data-color", "blue");
					} else if (hue <= 290 || (hue <= 300 && rex < 192)) { // purple
						$(this).attr("data-color", "purple");
					} else if (hue <= 345) { // magenta
						$(this).attr("data-color", "magenta");
					} else {
						alert("error ! " + name);
					}
					$(this).find("td").first().html(create_block(name));
					/*
					//////////////////////////////////////////////////////////////
					// all colors -- 147
					//////////////////////////////////////////////////////////////
					var min = Math.min(r, g, b);
					r -= min; g -= min; b -= min;
					var max = Math.max(r, g, b);
					if (max > 0){
						r /= max; g /= max; b /= max;
						//console.log(name + " : r = " + r, "g = " + g, "b = " + b); // DEBUG
					} else {
						//console.log("NaN : " + name);// DEBUG
					}
					//////////////////////////////////////////////////////////////
					// white and black colors -- 60
					//////////////////////////////////////////////////////////////
					if (rex < 48 && gex < 48 && bex < 48) { // black
						$(this).attr("data-color", "black");
					} else if (rex > 224 && gex > 224 && bex > 224) { // white
						$(this).attr("data-color", "white");
					//////////////////////////////////////////////////////////////
					// true colors -- 60
					//////////////////////////////////////////////////////////////
					} else if (r == g && r == b) { // true gray -- 13
						$(this).attr("data-color", "gray");
					} else if (r == g && r > b) { // true yellow -- 6
						$(this).attr("data-color", "yellow");
					} else if (r == g) { // true blue -- 7
						$(this).attr("data-color", "blue");
					} else if (r == b && r > g) { // true magenta -- 7
						$(this).attr("data-color", "pink");
					} else if (r == b) { // true green -- 9
						$(this).attr("data-color", "green");
					} else if (g == b && g > r) { // true cyan -- 9
						$(this).attr("data-color", "cyan");
					} else if (g == b) { // true red -- 9
						$(this).attr("data-color", "red");
					//////////////////////////////////////////////////////////////
					// mixed colors -- 87
					//////////////////////////////////////////////////////////////
					} else if (r == 1 && g == 0) { // mixed red (pink) -- 9
						$(this).attr("data-color", "pink");
					} else if (r == 1 && b == 0) { // mixed yellow (orange/brown) -- 36
						$(this).attr("data-color", "orange");
					} else if (g == 1 && r == 0) { // mixed cyan (green) -- 10
						$(this).attr("data-color", "cyan");
					} else if (g == 1 && b == 0) { // mixed green (yellow) -- 6
						$(this).attr("data-color", "green");
					} else if (b == 1 && r == 0) { // mixed blue (cyan) -- 17
						$(this).attr("data-color", "blue");
					} else if (b == 1 && g == 0) { // mixed magenta (purple) -- 9
						$(this).attr("data-color", "purple");
					}
					*/
				});
				$("#css_colors_toggle a").click(function() {
					if (!$(this).hasClass("active")) {
						$("#css_colors_table tr:not(:first):visible").hide();
						$("#css_colors_table [data-color='" + $(this).attr("data-show") +"']").show();
					} else {
						$("#css_colors_table tr").show();
					}
				});
			});
		</script>
		<script>
			$(document).foundation();
			loap.update()
		</script>
	</body>
</html>

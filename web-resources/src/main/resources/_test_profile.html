<!doctype html>
<html lang="fr">
	<head>
		<script src="boot.js"></script>
	</head>
	<body>

		<h2 class="red">Profil <small>.user-profile</small></h2>

		<!--Dev Testbar-->
		<div id="dev_testbar">
			<svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" viewBox="0 0 48 48">
				<polygon points="27,35.59 40,22.59 40,31.91 24,47.91 8,31.91 8,22.59 21,35.59 21,0 27,0 "/>
			</svg>
			<h4>Voir</h4>
			<label for="show_user_profile_show">Vue Profil</label>
			<input id="show_user_profile_show" type="checkbox" name="show" value="user-profile-show" checked>
			<label for="show_user_profile_update">Mise à jour Profil</label>
			<input id="show_user_profile_update" type="checkbox" name="show" value="user-profile-update" checked>
			<label for="show_user_articles_list">Liste des articles</label>
			<input id="show_user_articles_list" type="checkbox" name="show" value="related-list">
			<label for="toggle_css_debug">Masques CSS</label>
			<input id="toggle_css_debug" type="checkbox">
		</div>
		<script>
		// vars
		// events
		$("html").on("click", "#toggle_css_debug", function() {
			$("body").toggleClass("css-debug");
		});
		$("html").on("click", "[name='show']", function() {
			var f = $(this).val();
			$("." + f).toggle();
		});
		// init
		$(document).ready(function() {
			if ($("#toggle_css_debug").is(":checked")) {
				if ($("body").hasClass("css-debug")) {
					$("body").removeClass("css-debug");
				} else {
					$("body").addClass("css-debug");
				}
			}
			$("[name='show']").each(function() {
				var f = $(this).val();
				if ($(this).is(":checked")) {
					$("." + f).show();
				} else {
					$("." + f).hide();
				}
			});
		});
		</script>

		<div id="container" style="margin-left: 12.5%; width: 75%;">
			<!--User Profile Show-->
			<div class="row panel radius user-profile user-profile-show">
				<div class="column small-24 medium-10 large-8 text-center">
					<!--User picture-->
					<span class="picture large cover radius max-height" data-image="img/usr/usr-nadejda.jpg">Nadejda</span>
				</div>
				<div class="column small-24 medium-14 large-16">
					<div class="clearfix" style="position: relative;">
						<!--Pseudo-->
						<h3 class="user-name">MyUsername</h3>
						<!--Role-->
						<h4 class="user-role">MyRole</h4>
					</div>
					<!--User links-->
					<ul id="user_links_icons" class="inline-list">
						<li><a href="javascript:void(0)" class="icon-mail tip-top" title="Adresse email" data-tooltip><span class="hide">Adresse mail</span></a></li>
						<li><a href="javascript:void(0)" class="icon-link tip-top" title="Blog ou page perso" data-tooltip><span class="hide">Page perso</span></a></li>
						<li><a href="javascript:void(0)" class="icon-twitter tip-top" title="Twitter" data-tooltip><span class="hide">Twitter</span></a></li>
						<li><a href="javascript:void(0)" class="icon-facebook tip-top" title="Facebook" data-tooltip><span class="hide">Facebook</span></a></li>
						<li><a href="javascript:void(0)" class="icon-googleplus tip-top" title="Google+" data-tooltip><span class="hide">Google+</span></a></li>
						<li><a href="javascript:void(0)" class="icon-linkedin tip-top" title="LinkedIn" data-tooltip><span class="hide">LinkedIn</span></a></li>
					</ul>
					<p class="user-desc">MyDescription</p>
				</div>
				<!--User Articles List-->
				<div class="column small-24">
					<ul class="no-bullet related-list">
						<li><span class="icon-educult small"><span class="hide">Éducation & Culture</span></span> <a href="#">Sexisme dans les jeux-vidéos, une critique impossible ?</a> <span class="overview-tip"></span>
							<div class="overview" style="display: none;">
								<time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time>
								Ces dernières années sur le net et dans les milieux féministes anglophones et francophones, des débats et discussions sont nés autour de la question des représentations sexistes dans les jeux-vidéos et des comportements sexistes parmi les joueurs. Les réactions de rejet particulièrement virulentes de la part de ceux qui se sentent mis en cause, comme on a pu le constater suite aux déchaînements qu’ont subis entres autres Anita Sarkeesian et Mar-Lard, conduisent cependant à s’interroger sur la possibilité même de mener une telle réflexion.
							</div>
						</li>
						<li><span class="icon-ourbody small"><span class="hide">Nos corps, nous-mêmes</span></span> <a href="#">Stérilisation : « Une femme qui décide de ne pas vouloir avoir des enfants, c’est toujours louche »</a> <span class="overview-tip"></span>
							<div class="overview" style="display: none;">
								<time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time>
								Se faire stériliser en France relève d’un vrai combat pour les femmes qui veulent y recourir. Elles se heurtent aux refus des médecins, qui posent leurs propres conditions. Véronique Séhier, co-présidente Planning Familial, a répondu à nos questions sur ce sujet tabou dans notre société.
							</div>
						</li>
						<li><span class="icon-intersec small"><span class="hide">Intersectionnalité</span></span> <a href="#">Naturalisation et paupérisation du travail des femmes : le cas des services à la personne</a> <span class="overview-tip"></span>
							<div class="overview" style="display: none;">
								<time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time>
								Les services à la personne constituent une part non négligeable de l’emploi et de l’économie.  Avec 1,8 million de salariéEs (sans compter les assistantes maternelles), ils dépassent même le nombre d’équivalent temps plein du secteur de la construction (qui en compte 1,347 million). Pourtant, l’invisibilisation de ce pan de l’économie va de pair avec sa dévalorisation sociale.
							</div>
						</li>
						<li><span class="icon-rubric small"></span> <a href="#" class="tip-top" title="Pas de date" data-tooltip>Lorem Ipsum Dolor Sit Amet</a></li>
						<li><span class="icon-rubric small"></span> <a href="#" class="tip-top" title="Date masquée" data-tooltip>Lorem Ipsum Dolor Sit Amet</a> <time datetime="2014-09-01" class="hide"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time></li>
						<li><span class="icon-rubric small"></span> <a href="#" class="tip-top" title="Date à la suite" data-tooltip>Lorem Ipsum Dolor Sit Amet</a> <time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time></li>
						<li><span class="icon-rubric small"></span> <a href="#" class="tip-top" title="Date à la fin de la ligne" data-tooltip>Lorem Ipsum Dolor Sit Amet</a> <time datetime="2014-09-01" class="right"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time></li>
					</ul>
				</div>
			</div>

			<script>
				// user articles list info box slider
				var triggerer = ".overview-tip";
				var triggered = ".overview";
				$(triggerer).click(function() {
					var obj = $(this);
					if (obj.data("is_sliding") !== "true") {
						obj.data("is_sliding", "true");
						obj.toggleClass("active");
						if ($conf.js_fx) {
							obj.next(triggered).slideToggle(250, function() {
								obj.removeData("is_sliding");
							});
						} else {
							obj.next(triggered).toggle();
							obj.removeData("is_sliding");
						}
					}
				});
			</script>

			<!--User Profile Update--->
			<div class="row panel radius user-profile user-profile-update">
				<div class="column small-24 medium-10 large-8 text-center">

					<!--User picture-->
					<div style="display: inline-block; width: 256px; max-width: 100%;">
						<div class="user-picture">
							<a href="javascript:void(0)" id="delete_avatar" class="icon-remove round tip-top red" title="Supprimer l&rsquo;image utilisatrice" data-tooltip><span class="text hide">Supprimer</span></a>
							<a href="javascript:void(0)" id="avatar" class="picture large cover radius max-height tip-top" title="Faites glisser et d&eacute;posez votre image&thinsp;!" data-tooltip data-image="img/usr/usr-nadejda.jpg">Nadejda</a>
						</div>
						<input id="avatar_file" type="file">
						<div class="progress radius">
							<span class="meter" style="width: 100%;">100</span>
						</div>
					</div>
					<script>
						// Confirm Delete Avatar
						$(document).on("click", "#delete_avatar", function() {
							var modal_options = {
								"text" : $msg.confirm_delete_avatar,
								"class" : "panel radius",
								"on_confirm" :function() {
									// delete avatar
								}
							};
							$(this).create_confirmation_modal(modal_options);
						});
					</script>

				</div>
				<div class="column small-24 medium-14 large-16">
					<!--Disabled-->
					<label for="pseudo_disabled" class="left red">Disabled (attribute 'disabled' is set)</label>
					<input id="pseudo_disabled" class="user-name validation-icon" type="text" value="MyUsername" disabled="disabled">
					<small id="pseudoError" class="error hide">Le pseudo ne peut &ecirc;tre vide</small>

					<!--Readonly-->
					<label for="pseudo_readonly" class="left red">Readonly (attribute 'readonly' is set)</label>
					<input id="pseudo_readonly" class="user-name validation-icon" type="text" value="MyUsername" readonly="readonly">
					<small id="pseudoError" class="error hide">Le pseudo ne peut &ecirc;tre vide</small>

					<label for="pseudo" class=" red">Enabled (default)</label>
					<div class="clearfix" style="position: relative;">
						<!--Default-->
						<input id="pseudo" class="user-name validation-icon tip-top" type="text" maxlength="24" value="MyUsername" title="Votre nom d&rsquo;utilisatrice" placeholder="Nom d&rsquo;utilistratice" data-tooltip>
						<small id="pseudoError" class="error hide">Le nom d&rsquo;utilistatrice doit obligatoirement &ecirc;tre renseign&eacute;</small>
						<!--User role-->
						<h4 id="role" class="user-role">MyRole</h4>
					</div>

					<!--User links-->
					<div id="user-link">
						<span class="prefix text-small left"></span>
						<input class="left" type="text" placeholder="L&rsquo;adresse internet de votre lien">
					</div>
					<ul id="user_links_icons" class="inline-list">
						<li><a href="javascript:void(0)" class="icon-mail tip-top" title="1" data-tooltip><span class="hide">Adresse mail</span></a></li>
						<li><a href="javascript:void(0)" class="icon-link tip-top" title="2" data-tooltip data-url-prefix="http://"><span class="hide">Page perso</span></a></li>
						<li><a href="javascript:void(0)" class="icon-twitter tip-top" title="2" data-tooltip data-url-prefix="https://www.twitter.com/"><span class="hide">Twitter</span></a></li>
						<li><a href="javascript:void(0)" class="icon-facebook tip-top" title="3" data-tooltip data-url-prefix="https://www.facebook.com/"><span class="hide">Facebook</span></a></li>
						<li><a href="javascript:void(0)" class="icon-googleplus tip-top" title="4" data-tooltip data-url-prefix="https://plus.google.com/"><span class="hide">Google+</span></a></li>
						<li><a href="javascript:void(0)" class="icon-linkedin tip-top" title="5" data-tooltip data-url-prefix="https://www.linkedin.com/"><span class="hide">LinkedIn</span></a></li>
					</ul>

					<!--User description disabled-->
					<label for="description_disabled" class="red">Disabled (attribute 'disabled' is set)</label>
					<textarea id="description_disabled" class="user-desc min" maxlength="255" disabled="disabled" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

					<!--User description readonly-->
					<label for="description_readonly" class="red">Readonly (attribute 'readonly' is set)</label>
					<textarea id="description_readonly" class="user-desc min" maxlength="255" readonly="readonly" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

					<!--User description default-->
					<label for="description" class="red">Enabled (default)</label>
					<textarea id="description" class="user-desc min" maxlength="255" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

				</div>

			</div>
		</div>

		<!--The very big trash-->
		<script>
			function create_icons_input(options) {
				var defaults = {
					"input_container" : "",
					"icons_container" : "",
					//"icons_selector" : "[class*='icon-']",
					"icons_selector" : "[class*='icon']",
					"icons_title_prefix" : "",
					"icons_tooltip" : true,
					"animation_delay" : ($conf.js_fx ? 250 : 0)
				};
				// vars
				var options = $.extend({}, defaults, options);
				var input_container_margin_bottom = parseInt($(options.input_container).find("input").css("margin-bottom"));
				var icons_container_margin_bottom = parseInt($(options.icons_container).css("margin-bottom"));
				var is_icon_hover = false;
				// functions
				function show_input_container() {
					var obj = $(options.input_container + " input");
					var url = typeof $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url") === "undefined" ? "" : $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url");
					var url_prefix = typeof $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url-prefix") === "undefined" ? false : $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url-prefix");
					setTimeout(function() {
						$(options.input_container).fadeIn(options.animation_delay, function() {
							$(options.input_container + " input").css("margin-bottom", "0");
							$(options.input_container).css("margin-bottom", input_container_margin_bottom + "px");
							$(options.input_container + " .prefix").css("border-color", "darkgray");
							$(options.input_container).find("input").css("box-shadow", "none");
							$(options.input_container).css("box-shadow", "0 0 .25rem rgba(0, 0, 0, .5)");
						});
						obj.val(url);
						obj.select_text(0, obj.val().length);
						$(options.input_container).css("width", "100%");
						// set input prefix visibility
						if (!url_prefix) {
							$(options.input_container + " .prefix").hide();
							$(options.input_container + " input").css("width", "100%");
						} else {
							$(options.input_container + " .prefix").show();
							$(options.input_container + " .prefix").text(url_prefix);
							$(options.input_container + " .prefix").css({
								"width" : "auto",
								"display" : "inline-block"
							});
							// adjust input width
							var w = $(options.input_container).innerWidth() - $(options.input_container + " .prefix").outerWidth(true);
							var w_adj = parseInt($("html").css("font-size")) * 1.25; // REM to px conversion
							$(options.input_container + " input").width(w - w_adj);
							$(options.input_container).css("width", "auto");
						}
						// adjust container horizontal position
						var h = $(options.input_container).outerHeight(true);
						$(options.icons_container).css({"top" : h + "px", "margin-bottom" : h + icons_container_margin_bottom + "px"});
					}, options.animation_delay);
				}
				function hide_input_container() {
					$(options.input_container + "").fadeOut(options.animation_delay);
					check_icons_enabling($(options.icons_container + " " + options.icons_selector + ".active"));
					$(options.icons_container + " " + options.icons_selector).removeClass("active");
					setTimeout(function() {
						$(options.icons_container).css({"top" : "0", "margin-bottom" : icons_container_margin_bottom});
					}, options.animation_delay);
				}
				function check_icons_enabling(obj) {
					if (typeof obj.attr("data-url") === "undefined" || obj.attr("data-url") == "") {
						obj.addClass("disabled");
					} else {
						obj.removeClass("disabled");
					}
				}
				// events
				$(options.icons_container + " " + options.icons_selector).on("mouseenter", function() {
					is_icon_hover = true;
					if (!$(this).hasClass("active") && $(this).hasClass("disabled")) {
						$(this).css({
							"cursor" : "pointer",
							"outline" : "1px dotted gray",
							"background-color" : "rgba(255, 255, 255, .5)",
							"border-radius" : "0",
							"opacity" : "1"
						});
					}
				});
				$(options.icons_container + " " + options.icons_selector).on("mouseleave", function() {
					is_icon_hover = false;
					$(this).css({"cursor" : "", "outline" : "", "background-color" : "", "border-radius" : "", "opacity" : ""});
					if (!$(this).hasClass("active")) {
						if (typeof $(this).attr("data-url") === "undefined" || $(this).attr("data-url") == "") {
							$(this).addClass("disabled");
						}
					}
				});
				$(options.icons_container + " " + options.icons_selector).on("click", function() {
					$(options.icons_container + " " + options.icons_selector).removeClass("active");
					$(this).removeClass("disabled");
					$(this).addClass("active");
					show_input_container()
				});
				$(options.input_container + " input").on("blur", function() {
					$(options.icons_container + " " + options.icons_selector + ".active").attr("data-url", $(this).val());
					if (is_icon_hover == false) {
						hide_input_container()
					} else {
						check_icons_enabling($(options.icons_container + " " + options.icons_selector + ".active"));
					}
				});
				$(options.input_container + " input").on("keyup", function(event) {
					if (event.which == 13) { // Enter
						$(options.icons_container + " " + options.icons_selector + ".active").attr("data-url", $(this).val());
						hide_input_container()
					}
					if (event.which == 27) { // Escape
						hide_input_container()
					}
				});
				// init
				$(document).ready(function() {
					$(options.input_container).wrap("<div style='position: relative;'></div>");
					$(options.input_container).css({"position" : "absolute", "width" : "100%", "display" : "none"});
					$(options.icons_container).css({"position" : "relative", "top" : "0", "margin-bottom" : icons_container_margin_bottom, "transition" : "top " + options.animation_delay + "ms, margin-bottom " + options.animation_delay + "ms"});
					$(options.icons_container + " " + options.icons_selector).each(function() {
						var str = $(this).text();
						if (typeof str !== "undefined" && str != "") {
							if (options.icons_tooltip) {
								$(this).reload_tooltip(options.icons_title_prefix + str);
							}
						}
						check_icons_enabling($(this));
					});
				});
			}

			function set_role_display() {
				// functions
				function update_role_display(clear) {
					var screen_width = 1023; // WARNING : should be the same as css file for this to work properly
					if (window.matchMedia("(min-width: " + screen_width + "px)").matches) {
						var clear = clear || false;
						$("h3.user-name").css("padding-right", $("#role").outerWidth());
						$("input.user-name").css("padding-right", parseFloat($("#role").width()) + parseFloat($("body").css("font-size").replace("px", "")));
						$("#role").css({
							"color" : (clear ? "" : "gray"),
							"text-shadow" : (clear ? "" : "none")
						});
					} else {
						$("h3.user-name").css("padding-right", "");
						$("input.user-name").css("padding-right", "");
					}
				}
				// events
				$("#pseudo").bind({ // bind role display events to pseudo
					mouseenter: function() {update_role_display();},
					mouseleave: function() {if (!$(this).is(":focus")) {update_role_display(true);}},
					focus: function() {update_role_display();},
					blur: function() {if (!$(this).is(":focus")) {update_role_display(true);}}
				});
				$(window).resize(function() {
					update_role_display(true);
				});
				update_role_display(true);
			}

			// define icons input variables
			var user_links = {
				"input_container" : ".user-profile-update #user-link",
				"icons_container" : ".user-profile-update #user_links_icons",
				"icons_title_prefix" : "Votre "
			};

			// define page startup instructions
			$(document).ready(function() {
				create_icons_input(user_links); // Process user links
				set_role_display(); // Apply role display changing
			});

		</script>

<script>
			$build.container = false;
			load();
		</script>
		<script>
			$(document).ready(function(){
				$("textarea").add_confirmation_bar(); // apply add_confirmation_bar plugin to all textarea of the page
			});
		</script>
	</body>
</html>

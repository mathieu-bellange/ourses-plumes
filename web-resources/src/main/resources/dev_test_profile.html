<!doctype html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<script src="boot"></script>
	</head>
	<body>
		<div style="min-height: 100%; padding: 1rem; background-color: white;">

			<h2 class="red">Profil <small>.user-profile</small></h2>

			<div class="row panel radius user-profile">

				<div class="column small-12 medium-5 large-4 text-center">

					<!--User picture-->
					<span class="picture large cover radius max-height" data-image="usr/usr-nadejda.jpg">Nadejda</span>

					<!--User links-->
					<div id="user-link">
						<input type="text" placeholder="L&rsquo;URL de votre lien (p. ex. http://marie.blogspot.fr/)">
					</div>
					<ul id="user_links_icons" class="inline-list">
						<li><a href="javascript:void(0)" class="icon-mail medium">Adresse mail</a></li>
						<li><a href="javascript:void(0)" class="icon-home medium">Site internet</a></li>
						<li><a href="javascript:void(0)" class="icon-link medium">Page perso</a></li>
					</ul>

				</div>

				<div class="column small-12 medium-7 large-8 text-center">

					<!--Disabled-->
					<label for="pseudo" class="left red">Disabled (attribute 'disabled' is set)</label>
					<input id="pseudo" type="text" value="MyUsername" class="validation-icon" disabled="disabled">
					<small id="pseudoError" class="error hide">Le pseudo ne peut &ecirc;tre vide</small>

					<!--Readonly-->
					<label for="pseudo" class="left red">Readonly (attribute 'readonly' is set)</label>
					<input id="pseudo" type="text" value="MyUsername" class="validation-icon" readonly="readonly">
					<small id="pseudoError" class="error hide">Le pseudo ne peut &ecirc;tre vide</small>

					<!--Default-->
					<label for="pseudo" class="left red">Enabled (default)</label>
					<input id="pseudo" type="text" value="MyUsername" class="validation-icon">
					<small id="pseudoError" class="error hide">Le pseudo doit &ecirc;tre renseign&eacute;</small>

					<!--User role-->
					<div class="clearfix">
						<h4 class="left">MyRole</h4>
						<!--UNUSED-->
						<!--<time datetime="2014-07-23" class="right text-steel"><small>Depuis le JJ mois AAAA</small></time>-->
					</div>

					<!--User description disabled-->
					<label for="description" class="left red">Disabled (attribute 'disabled' is set)</label>
					<textarea id="description" class="min" maxlength="255" disabled="disabled" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

					<!--User description readonly-->
					<label for="description" class="left red">Readonly (attribute 'readonly' is set)</label>
					<textarea id="description" class="min" maxlength="255" readonly="readonly" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

					<!--User description default-->
					<label for="description" class="left red">Enabled (default)</label>
					<textarea id="description" class="min test-txtarea" maxlength="255" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

					<hr>

					<!--Social links-->
					<div id="social-link" class="row collapse">
						<div class="column small-6">
							<span class="prefix text-small"></span>
						</div>
						<div class="column small-6">
							<input type="text" placeholder="Votre adresse sur le r&eacute;seau social">
						</div>
					</div>
					<ul id="social_links_icons" class="inline-list">
						<li><a href="javascript:void(0)" class="icon-twitter medium" data-url-prefix="https://www.twitter.com/">Twitter</a></li>
						<li><a href="javascript:void(0)" class="icon-facebook medium" data-url-prefix="https://www.facebook.com/">Facebook</a></li>
						<li><a href="javascript:void(0)" class="icon-googleplus medium" data-url-prefix="https://plus.google.com/">Google+</a></li>
						<li><a href="javascript:void(0)" class="icon-linkedin medium" data-url-prefix="https://www.linkedin.com/">LinkedIn</a></li>
					</ul>

				</div>
			</div>

		</div>
		<script>

			/**
			 * New Function : set_icons_input()
			 */
			function set_icons_input(options) {
				var defaults = {
					"input_container" : "",
					"icons_container" : "",
					"icons_selector" : "[class*='icon-']",
					"icons_title_prefix" : "",
					"icons_tooltip" : true,
					"animation_delay" : 250
				};
				var options = $.extend({}, defaults, options);
				function check_icons_enabling(obj) {
					if (typeof obj.attr("data-url") === "undefined" || obj.attr("data-url") == "") {
						obj.addClass("disabled");
					} else {
						obj.removeClass("disabled");
					}
				}
				function hide_input_container() {
					$(options.input_container + "").fadeOut(options.animation_delay);
					check_icons_enabling($(options.icons_container + " " + options.icons_selector + ".active"));
					$(options.icons_container + " " + options.icons_selector).removeClass("active");
					setTimeout(function() {
						$(options.icons_container).css({"top" : "0", "margin-bottom" : "0"});
					}, options.animation_delay);
				}
				var is_icon_hover = false;
				$(options.icons_container + " " + options.icons_selector).on("mouseenter", function() {
					is_icon_hover = true;
					if (!$(this).hasClass("active") && $(this).hasClass("disabled")) {
						$(this).css({
							"cursor" : "pointer",
							"outline" : "1px dotted gray",
							"background-color" : "rgba(255, 255, 255, .5)",
							"opacity" : "1"
						});
					}
				});
				$(options.icons_container + " " + options.icons_selector).on("mouseleave", function() {
					is_icon_hover = false;
					$(this).css({"cursor" : "", "outline" : "", "background-color" : "", "opacity" : ""});
					if (!$(this).hasClass("active")) {
						if (typeof $(this).attr("data-url") === "undefined" || $(this).attr("data-url") == "") {
							$(this).addClass("disabled");
						}
					}
				});
				$(options.icons_container + " " + options.icons_selector).on("click", function() {
					$(options.icons_container + " " + options.icons_selector).removeClass("active");
					$(this).removeClass("disabled");
					$(this).addClass("active");
					var h = $(options.input_container).outerHeight(true);
					var obj = $(options.input_container + " input");
					var url = typeof $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url") === "undefined" ? "" : $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url");
					var url_prefix = typeof $(this).attr("data-url-prefix") === "undefined" ? "http://" : $(this).attr("data-url-prefix");
					$(options.input_container + " .prefix").text(url_prefix);
					setTimeout(function() {
						$(options.input_container + "").fadeIn(options.animation_delay);
						obj.val(url);
						obj.cursor_position(0, obj.val().length);
					}, options.animation_delay);
					$(options.icons_container).css({"top" : h + "px", "margin-bottom" : h + "px"});
				});
				$(options.input_container + " input").on("blur", function() {
					$(options.icons_container + " " + options.icons_selector + ".active").attr("data-url", $(this).val());
					if (is_icon_hover == false) {
						hide_input_container()
					} else {
						check_icons_enabling($(options.icons_container + " " + options.icons_selector + ".active"));
					}
				});
				$(options.input_container + " input").on("keydown", function(event) {
					if (event.which == 13) { // Enter
						$(options.icons_container + " " + options.icons_selector + ".active").attr("data-url", $(this).val());
						hide_input_container()
					}
					if (event.which == 27) { // Escape
						hide_input_container()
					}
				});
				$(document).ready(function() {
					$(options.input_container).wrap("<div style='position: relative;'></div>");
					$(options.input_container).css({"position" : "absolute", "width" : "100%", "display" : "none"});
					$(options.icons_container).css({"position" : "relative", "top" : "0", "margin-bottom" : "0", "transition" : "top " + options.animation_delay + "ms, margin-bottom " + options.animation_delay + "ms"});
					$(options.icons_container + " " + options.icons_selector).each(function() {
						var str = $(this).text();
						$(this).attr("title", options.icons_title_prefix + str);
						if (options.icons_tooltip) {
							$(this).addClass("tip-top");
							$(this).attr("data-tooltip", "");
							$(options.icons_container).foundation("tooltip");
						}
						check_icons_enabling($(this));
					});
				});
			}

			// Define Icons Input Variables
			var user_links = {
				"input_container" : "#user-link",
				"icons_container" : "#user_links_icons",
				"icons_title_prefix" : "Votre "
			};
			var social_links = {
				"input_container" : "#social-link",
				"icons_container" : "#social_links_icons",
				"icons_title_prefix" : "Votre page "
			};
			// Process Icons Input
			set_icons_input(social_links);
			set_icons_input(user_links);

		</script>
		<script>
			$build_container = false;
			load();
		</script>
		<script>
			loap.update()
			$(document).ready(function(){
				$('textarea').autosize({append: ""}); // apply autosize plugin to all textarea of the page
				$("textarea").validation_bar(); // apply validation_bar plugin to all textarea of the page
			});
		</script>
		<script>
			$(document).foundation();
		</script>
	</body>
</html>

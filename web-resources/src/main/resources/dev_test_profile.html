<!doctype html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<script src="boot"></script>
	</head>
	<body>

		<h2 class="red">Profil <small>.user-profile</small></h2>

		<!--Dev Test Editor Toolbar-->
		<style>
			#dev_test_profile_toolbar {padding: .5rem 1.5rem;}
			#dev_test_profile_toolbar > h4 {display: inline-block; margin-right: .5rem; color: darkgray;}
			#dev_test_profile_toolbar > label {margin: 0 0 0 .5rem;}
			#dev_test_profile_toolbar > input[type="checkbox"] {margin: 0; vertical-align: middle;}
		</style>
		<div id="dev_test_profile_toolbar" class="panel">
			<h4 class="text-medium">Show</h4>
			<label for="show_user_profile_show">Vue Profil</label>
			<input id="show_user_profile_show" type="checkbox" name="show" value="user-profile-show">
			<label for="show_user_profile_update">Mise à jour Profil</label>
			<input id="show_user_profile_update" type="checkbox" name="show" value="user-profile-update" checked>
			<label for="show_user_articles_list">Liste des articles</label>
			<input id="show_user_articles_list" type="checkbox" name="show" value="user-articles-list" checked>
			<label for="toggle_css_debug">Masques CSS</label>
			<input id="toggle_css_debug" type="checkbox" value="user-articles-list">
		</div>
		<script>
		// Methods
		function set_css_debug(selector) {
			if ($("." + selector).parents(".row").hasClass("css-debug")) {
				$("." + selector).parents(".row").removeClass("css-debug");
			} else {
				$("." + selector).parents(".row").addClass("css-debug");
			}
		}
		// Events
		$("html").on("click", "#toggle_css_debug", function() {
			set_css_debug($(this).val());
		});
		$("html").on("click", "[name='show']", function() {
			var f = $(this).val();
			$("." + f).toggle();
		});
		// Init
		$(document).ready(function() {
			if ($("#toggle_css_debug").is(":checked")) {
				set_css_debug($("#toggle_css_debug").val());
			}
			$("[name='show']").each(function() {
				var f = $(this).val();
				if ($(this).is(":checked")) {
					$("." + f).show();
				} else {
					$("." + f).hide();
				}
			});
		});
		</script>

		<!--User Profile Show-->
		<div class="row panel radius user-profile user-profile-show">
			<div class="column small-12 medium-5 large-4 text-center">
				<!--User picture-->
				<div class="picture large cover radius max-height" data-image="usr/usr-nadejda.jpg">Nadejda</div>
			</div>
			<div class="column small-12 medium-7 large-8">
				<div class="clearfix" style="position: relative;">
					<!--Pseudo-->
					<h3 class="user-name">MyUsername</h3>
					<!--Role-->
					<h4 class="user-role">MyRole</h4>
				</div>
				<!--User links-->
				<ul id="user_links_icons" class="inline-list block">
					<li><a href="javascript:void(0)" class="icon-mail medium">Adresse mail</a></li>
					<li><a href="javascript:void(0)" class="icon-link medium">Page perso</a></li>
					<li><a href="javascript:void(0)" class="icon-twitter medium">Twitter</a></li>
					<li><a href="javascript:void(0)" class="icon-facebook medium">Facebook</a></li>
					<li><a href="javascript:void(0)" class="icon-googleplus medium">Google+</a></li>
					<li><a href="javascript:void(0)" class="icon-linkedin medium">LinkedIn</a></li>
				</ul>
				<p>MyDescription</p>
			</div>
		</div>

		<!--User Profile Update--->
		<div class="row panel radius user-profile user-profile-update">
			<div class="column small-12 medium-5 large-4 text-center">

				<!--User picture-->
				<div class="picture large cover radius max-height" data-image="usr/usr-nadejda.jpg">Nadejda</div>

			</div>
			<div class="column small-12 medium-7 large-8">

				<!--Disabled-->
				<label for="pseudo_disabled" class="left red">Disabled (attribute 'disabled' is set)</label>
				<input id="pseudo_disabled" type="text" value="MyUsername" class="validation-icon" disabled="disabled">
				<small id="pseudoError" class="error hide">Le pseudo ne peut &ecirc;tre vide</small>

				<!--Readonly-->
				<label for="pseudo_readonly" class="left red">Readonly (attribute 'readonly' is set)</label>
				<input id="pseudo_readonly" type="text" value="MyUsername" class="validation-icon" readonly="readonly">
				<small id="pseudoError" class="error hide">Le pseudo ne peut &ecirc;tre vide</small>

				<label for="pseudo" class=" red">Enabled (default)</label>
				<div class="clearfix" style="position: relative;">
					<!--Default-->
					<input id="pseudo" type="text" value="MyUsername" class="user-name validation-icon wrong" title="Nom d&rsquo;utilisatrice" placeholder="Votre nom d&rsquo;utilistratice">
					<small id="pseudoError" class="error hide">Le nom d&rsquo;utilistatrice doit obligatoirement &ecirc;tre renseign&eacute;</small>
					<!--User role-->
					<h4 id="role" class="user-role">MyRole</h4>
				</div>

				<!--User links-->
				<div id="user-link">
					<span class="prefix text-small left"></span>
					<input class="left" type="text" placeholder="L&rsquo;adresse internet de votre lien">
				</div>
				<ul id="user_links_icons" class="inline-list block">
					<li><a href="javascript:void(0)" class="icon-mail medium">Adresse mail</a></li>
					<li><a href="javascript:void(0)" class="icon-link medium" data-url-prefix="http://">Page perso</a></li>
					<li><a href="javascript:void(0)" class="icon-twitter medium" data-url-prefix="https://www.twitter.com/">Twitter</a></li>
					<li><a href="javascript:void(0)" class="icon-facebook medium" data-url-prefix="https://www.facebook.com/">Facebook</a></li>
					<li><a href="javascript:void(0)" class="icon-googleplus medium" data-url-prefix="https://plus.google.com/">Google+</a></li>
					<li><a href="javascript:void(0)" class="icon-linkedin medium" data-url-prefix="https://www.linkedin.com/">LinkedIn</a></li>
				</ul>

				<!--User description disabled-->
				<label for="description" class="red">Disabled (attribute 'disabled' is set)</label>
				<textarea id="description" class="min" maxlength="255" disabled="disabled" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

				<!--User description readonly-->
				<label for="description" class="red">Readonly (attribute 'readonly' is set)</label>
				<textarea id="description" class="min" maxlength="255" readonly="readonly" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

				<!--User description default-->
				<label for="description" class="red">Enabled (default)</label>
				<textarea id="description" class="min" maxlength="255" placeholder="MyTextareaPlaceholder">MyDescription</textarea>

			</div>

		</div>

		<!--User Articles List-->
		<div class="row">
			<div class="column small-12 small-centered">
				<style>
				.special {
					position: absolute;
					display: inline-block;
					right: 0;
					top: 50%;
					width: 1.5rem;
					height: 1.5rem;
					line-height: 1.5rem;
					margin-top: -.75rem;
					color: dimgray;
					font-family: "Oswald";
					text-align: center;
					border-radius: 100%;
					background-color: whitesmoke;
					border: 1px solid darkgray;
					opacity: .5;
					-webkit-transition: all .25s ease-out;
						 -moz-transition: all .25s ease-out;
									transition: all .25s ease-out;
				}
				.special:hover {
					cursor: pointer;
					right: -.375rem;
					width: 2rem;
					height: 2rem;
					line-height: 2rem;
					margin-top: -1rem;
					font-size: 125%;
					opacity: 1;
				}
				.special:before {
					content: "?";
				}
				.special.active {
					color: white;
					border-color: dimgray;
					background-color: dimgray;
				}
				.special.active:before {
					content: "!";
				}
				.extra {
					position: relative;
					margin: .25rem 2rem 0 2rem;
					padding-top: .25rem;
					color: #666;
					font-size: .875em;
					text-align: justify;
					border-top: 1px dotted silver;
				}
				.css-debug .extra {
					background-color: rgba(255, 0, 0, .25);
				}
				.css-debug .user-articles-list {
					background-color: rgba(255, 255, 0, .25);
				}
				.css-debug .user-articles-list > li {
					background-color: rgba(0, 255, 255, .25);
				}
				</style>

				<ul class="no-bullet user-articles-list">
					<li><span class="icon-educult small">Éducation & Culture</span> <a href="#">Sexisme dans les jeux-vidéos, une critique impossible ?</a> <span class="special"></span>
						<div class="extra" style="display: none;">
							<time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time>
							Ces dernières années sur le net et dans les milieux féministes anglophones et francophones, des débats et discussions sont nés autour de la question des représentations sexistes dans les jeux-vidéos et des comportements sexistes parmi les joueurs. Les réactions de rejet particulièrement virulentes de la part de ceux qui se sentent mis en cause, comme on a pu le constater suite aux déchaînements qu’ont subis entres autres Anita Sarkeesian et Mar-Lard, conduisent cependant à s’interroger sur la possibilité même de mener une telle réflexion.
						</div>
					</li>
					<li><span class="icon-ourbody small">Nos corps, nous-mêmes</span> <a href="#">Stérilisation : « Une femme qui décide de ne pas vouloir avoir des enfants, c’est toujours louche »</a> <span class="special"></span>
						<div class="extra" style="display: none;">
							<time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time>
							Se faire stériliser en France relève d’un vrai combat pour les femmes qui veulent y recourir. Elles se heurtent aux refus des médecins, qui posent leurs propres conditions. Véronique Séhier, co-présidente Planning Familial, a répondu à nos questions sur ce sujet tabou dans notre société.
						</div>
					</li>
					<li><span class="icon-intersec small">Intersectionnalité</span> <a href="#">Naturalisation et paupérisation du travail des femmes : le cas des services à la personne</a> <span class="special"></span>
						<div class="extra" style="display: none;">
							<time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time>
							Les services à la personne constituent une part non négligeable de l’emploi et de l’économie.  Avec 1,8 million de salariéEs (sans compter les assistantes maternelles), ils dépassent même le nombre d’équivalent temps plein du secteur de la construction (qui en compte 1,347 million). Pourtant, l’invisibilisation de ce pan de l’économie va de pair avec sa dévalorisation sociale.
						</div>
					</li>
					<li><span class="icon-rubric small"></span> <a href="#" title="Pas de date" data-tooltip>Lorem Ipsum Dolor Sit Amet</a></li>
					<li><span class="icon-rubric small"></span> <a href="#" title="Date masquée" data-tooltip>Lorem Ipsum Dolor Sit Amet</a> <time datetime="2014-09-01" class="hide"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time></li>
					<li><span class="icon-rubric small"></span> <a href="#" title="Date à la suite" data-tooltip>Lorem Ipsum Dolor Sit Amet</a> <time datetime="2014-09-01"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time></li>
					<li><span class="icon-rubric small"></span> <a href="#" title="Date à la fin de la ligne" data-tooltip>Lorem Ipsum Dolor Sit Amet</a> <time datetime="2014-09-01" class="right"><small class="text-silver">1<sup>er</sup> septembre 2014</small></time></li>
				</ul>
			</div>
		</div>

		<!--Some script kiddy dirty things-->
		<script>
			/* User Articles List Expander  */
			var triggerer = ".special";
			var triggered = ".extra";
			$(triggerer).click(function() {
				var obj = $(this);
				if (obj.data("can_slide") === "true") {
					obj.data("can_slide", "false");
					obj.toggleClass("active");
					obj.next(triggered).slideToggle(250, function() {
						obj.data("can_slide", "true");
					});
				}
			});
			$(document).ready(function() {
				$(".special").data("can_slide", "true");
			});
		</script>

		<!--The very big trash lies below-->
		<script>
			function create_icons_input(options) {
				var defaults = {
					"input_container" : "",
					"icons_container" : "",
					"icons_selector" : "[class*='icon-']",
					"icons_title_prefix" : "",
					"icons_tooltip" : true,
					"animation_delay" : 250
				};
				// Vars
				var options = $.extend({}, defaults, options);
				var input_container_margin_bottom = parseInt($(options.input_container).find("input").css("margin-bottom"));
				var icons_container_margin_bottom = parseInt($(options.icons_container).css("margin-bottom"));
				var is_icon_hover = false;
				// Methods
				function show_input_container() {
					var obj = $(options.input_container + " input");
					var url = typeof $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url") === "undefined" ? "" : $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url");
					var url_prefix = typeof $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url-prefix") === "undefined" ? false : $(options.icons_container + " " + options.icons_selector + ".active").attr("data-url-prefix");
					setTimeout(function() {
						$(options.input_container).fadeIn(options.animation_delay, function() {
							$(options.input_container + " input").css("margin-bottom", "0");
							$(options.input_container).css("margin-bottom", input_container_margin_bottom + "px");
							$(options.input_container + " .prefix").css("border-color", "darkgray");
							$(options.input_container).find("input").css("box-shadow", "none");
							$(options.input_container).css("box-shadow", "0 0 .25rem rgba(0, 0, 0, .5)");
						});
						obj.val(url);
						obj.cursor_position(0, obj.val().length);
						$(options.input_container).css("width", "100%");
						// Set input prefix visibility
						if (!url_prefix) {
							$(options.input_container + " .prefix").hide();
							$(options.input_container + " input").css("width", "100%");
						} else {
							$(options.input_container + " .prefix").show();
							$(options.input_container + " .prefix").text(url_prefix);
							$(options.input_container + " .prefix").css({
								"width" : "auto",
								"display" : "inline-block"
							});
							// Adjust input width
							var w = $(options.input_container).innerWidth() - $(options.input_container + " .prefix").outerWidth(true);
							var w_adj = parseInt($("html").css("font-size")) * 1.25; // REM to px conversion
							$(options.input_container + " input").width(w - w_adj);
							$(options.input_container).css("width", "auto");
						}
						// Adjust container horizontal position
						var h = $(options.input_container).outerHeight(true);
						$(options.icons_container).css({"top" : h + "px", "margin-bottom" : h + icons_container_margin_bottom + "px"});
					}, options.animation_delay);
				}
				function hide_input_container() {
					$(options.input_container + "").fadeOut(options.animation_delay);
					check_icons_enabling($(options.icons_container + " " + options.icons_selector + ".active"));
					$(options.icons_container + " " + options.icons_selector).removeClass("active");
					setTimeout(function() {
						$(options.icons_container).css({"top" : "0", "margin-bottom" : icons_container_margin_bottom});
					}, options.animation_delay);
				}
				function check_icons_enabling(obj) {
					if (typeof obj.attr("data-url") === "undefined" || obj.attr("data-url") == "") {
						obj.addClass("disabled");
					} else {
						obj.removeClass("disabled");
					}
				}
				// Eventing
				$(options.icons_container + " " + options.icons_selector).on("mouseenter", function() {
					is_icon_hover = true;
					if (!$(this).hasClass("active") && $(this).hasClass("disabled")) {
						$(this).css({
							"cursor" : "pointer",
							"outline" : "1px dotted gray",
							"background-color" : "rgba(255, 255, 255, .5)",
							"opacity" : "1"
						});
					}
				});
				$(options.icons_container + " " + options.icons_selector).on("mouseleave", function() {
					is_icon_hover = false;
					$(this).css({"cursor" : "", "outline" : "", "background-color" : "", "opacity" : ""});
					if (!$(this).hasClass("active")) {
						if (typeof $(this).attr("data-url") === "undefined" || $(this).attr("data-url") == "") {
							$(this).addClass("disabled");
						}
					}
				});
				$(options.icons_container + " " + options.icons_selector).on("click", function() {
					$(options.icons_container + " " + options.icons_selector).removeClass("active");
					$(this).removeClass("disabled");
					$(this).addClass("active");
					show_input_container()
				});
				$(options.input_container + " input").on("blur", function() {
					$(options.icons_container + " " + options.icons_selector + ".active").attr("data-url", $(this).val());
					if (is_icon_hover == false) {
						hide_input_container()
					} else {
						check_icons_enabling($(options.icons_container + " " + options.icons_selector + ".active"));
					}
				});
				$(options.input_container + " input").on("keyup", function(event) {
					if (event.which == 13) { // Enter
						$(options.icons_container + " " + options.icons_selector + ".active").attr("data-url", $(this).val());
						hide_input_container()
					}
					if (event.which == 27) { // Escape
						hide_input_container()
					}
				});
				// Initialization
				$(document).ready(function() {
					$(options.input_container).wrap("<div style='position: relative;'></div>");
					$(options.input_container).css({"position" : "absolute", "width" : "100%", "display" : "none"});
					$(options.icons_container).css({"position" : "relative", "top" : "0", "margin-bottom" : icons_container_margin_bottom, "transition" : "top " + options.animation_delay + "ms, margin-bottom " + options.animation_delay + "ms"});
					$(options.icons_container + " " + options.icons_selector).each(function() {
						var str = $(this).text();
						$(this).attr("title", options.icons_title_prefix + str);
						if (options.icons_tooltip) {
							$(this).addClass("tip-top");
							$(this).attr("data-tooltip", "");
							$(options.icons_container).foundation("tooltip");
						}
						check_icons_enabling($(this));
					});
				});
			}

			function set_role_display() {
				// Define Methods
				function update_role_display(clear) {
					var screen_width = 1023; // WARNING : Should be the same as CSS file for this to work properly
					if (window.matchMedia("(min-width: " + screen_width + "px)").matches) {
						var clear = clear || false;
						$("#role").css({
							"color" : (clear ? "" : "gray"),
							"text-shadow" : (clear ? "" : "none")
						});
					}
				}
				// Bind Events
				$("#pseudo").bind({ // Bind role display events to pseudo
					mouseenter: function() {update_role_display();},
					mouseleave: function() {if (!$(this).is(":focus")) {update_role_display(true);}},
					focus: function() {update_role_display();},
					blur: function() {if (!$(this).is(":focus")) {update_role_display(true);}}
				});
			}

			// Define Icons Input Variables
			var user_links = {
				"input_container" : ".user-profile-update #user-link",
				"icons_container" : ".user-profile-update #user_links_icons",
				"icons_title_prefix" : "Votre "
			};

			// Define Page Startup Instructions
			$(document).ready(function() {
				create_icons_input(user_links); // Process user links
				set_role_display(); // Apply role display changing
			});

		</script>
		<script>

		var test = (function() {
			return {
				init : function(a) {
					if (a = 0) {
						alert("init 0");
					} else {
						alert("init somethign else");
					}
				},
				reload : function() {
					this.init(1);
				}
			}
		}());

		test.reload();

		</script>
		<script>
			$build_container = false;
			load();
		</script>
		<script>
			loap.update()
			$(document).ready(function(){
				$('textarea').autosize({append: ""}); // apply autosize plugin to all textarea of the page
				$("textarea").validation_bar(); // apply validation_bar plugin to all textarea of the page
			});
		</script>
		<script>
			$(document).foundation();
		</script>
	</body>
</html>
